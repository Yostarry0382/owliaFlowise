(()=>{var e={};e.id=234,e.ids=[234],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},84758:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=a(70260),o=a(28203),s=a(25155),n=a.n(s),l=a(67292),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);a.d(t,i);let d=["",{children:["agent-builder",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,97400)),"C:\\Users\\yrk20\\OwliaFabrica2\\app\\agent-builder\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,19611)),"C:\\Users\\yrk20\\OwliaFabrica2\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,19937,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\yrk20\\OwliaFabrica2\\app\\agent-builder\\page.tsx"],p={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/agent-builder/page",pathname:"/agent-builder",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},45604:(e,t,a)=>{Promise.resolve().then(a.bind(a,97400))},53220:(e,t,a)=>{Promise.resolve().then(a.bind(a,12878))},12878:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var r=a(45512),o=a(58009),s=a(20526),n=a(67625),l=a(82040),i=a(22387);a(17163);var d=a(20908),c=a(84438),p=a(77800),u=a(94205);let g=(0,a(66214).A)((0,r.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var x=a(79334),f=a(32493),h=a(54543),b=a(83505),y=a(3175),m=a(67263),v=a(85828),C=a(61986),j=a(17289);let k={custom:h.A},w={buttonedge:b.A},A=[],I=[];function P(){let e=(0,x.useRouter)(),t=(0,o.useRef)(null),[a,h]=(0,o.useState)(null),[b,P,S]=(0,s.ck)(A),[B,D,T]=(0,s.fM)(I),[O,_]=(0,o.useState)(null),[F,E]=(0,o.useState)(!1),[R,N]=(0,o.useState)(!1),[G,H]=(0,o.useState)(!1),[q,z]=(0,o.useState)([]),[$,M]=(0,o.useState)({open:!1,message:"",severity:"info"}),U=(0,o.useRef)();U.current=e=>{let t=b.find(t=>t.id===e);t&&(_(t),E(!0))};let J=(0,o.useRef)();J.current=e=>{P(t=>t.filter(t=>t.id!==e)),D(t=>t.filter(t=>t.source!==e&&t.target!==e)),O?.id===e&&(_(null),E(!1))};let K=(0,o.useCallback)(e=>{U.current?.(e)},[]),L=(0,o.useCallback)(e=>{J.current?.(e)},[]),V=(0,o.useCallback)(e=>{D(t=>(0,s.rN)({...e,type:"smoothstep",animated:!0},t))},[D]),W=(0,o.useCallback)(e=>{e.preventDefault();let r=e.dataTransfer.getData("application/reactflow");if(!r||!a||!t.current)return;let o=JSON.parse(r),s=a.screenToFlowPosition({x:e.clientX,y:e.clientY}),n={id:`${o.type}-${Date.now()}`,type:"custom",position:s,data:{label:o.label,type:o.type,category:o.category,config:{},agentId:o.agentId,agentName:o.agentId?o.label:void 0,onConfigure:K,onDelete:L}};P(e=>[...e,n])},[a,P,K,L]),X=(0,o.useCallback)(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),Y=(0,o.useCallback)((e,t)=>{_(t)},[]),Q=(0,o.useCallback)((e,t)=>{_(t),E(!0)},[]),Z=(0,o.useCallback)((e,t,a)=>{P(r=>r.map(r=>r.id===e?{...r,data:{...r.data,config:t,humanReview:a}}:r)),_(r=>r?.id===e?{...r,data:{...r.data,config:t,humanReview:a}}:r)},[P]),ee=(0,o.useCallback)(()=>{E(!1)},[]),et=(0,o.useCallback)(()=>{if(0===b.length){M({open:!0,message:"Please add at least one node before saving.",severity:"error"});return}N(!0)},[b]),ea=(0,o.useCallback)(async e=>{try{let t;e.syncToFlowise&&(t=(0,j.f2)(b,B));let a=await fetch("/api/owlagents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,flow:{nodes:b.map(e=>({id:e.id,type:e.data.type,position:e.position,data:{label:e.data.label,type:e.data.type,category:e.data.category,config:e.data.config,humanReview:e.data.humanReview,agentId:e.data.agentId,agentName:e.data.agentName}})),edges:B.map(e=>({id:e.id,source:e.source,target:e.target,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle}))},flowiseFlowData:t})});if(!a.ok)throw Error("Failed to save agent");let r=await a.json(),o=`Agent "${r.name}" saved successfully!`;r.flowiseChatflowId&&(o+=` (Flowise Chatflow: ${r.flowiseChatflowId})`),M({open:!0,message:o,severity:"success"}),N(!1),z(e=>[...e,{id:r.id,name:r.name,description:r.description}])}catch(e){M({open:!0,message:"Failed to save agent. Please try again.",severity:"error"})}},[b,B]),er=(0,o.useCallback)(()=>{if(0===b.length){M({open:!0,message:"Please add at least one node before testing.",severity:"error"});return}H(!0)},[b]),eo=()=>{M(e=>({...e,open:!1}))};return(0,r.jsx)(s.Ln,{children:(0,r.jsxs)(d.Box,{sx:{display:"flex",flexDirection:"column",height:"100vh",bgcolor:"#0f0f1a"},children:[(0,r.jsxs)(d.Paper,{sx:{borderRadius:0,bgcolor:"#16213e",borderBottom:"2px solid #0f3460",px:2,py:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(d.Tooltip,{title:"Back to Home",children:(0,r.jsx)(d.IconButton,{onClick:()=>e.push("/"),sx:{color:"#888"},children:(0,r.jsx)(g,{})})}),(0,r.jsxs)(d.Typography,{variant:"h6",sx:{fontWeight:700,color:"#fff",display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)("span",{style:{fontSize:"1.3rem"},children:"\uD83E\uDD89"}),"Agent Builder"]})]}),(0,r.jsxs)(d.Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(d.Button,{variant:"outlined",startIcon:(0,r.jsx)(p.A,{}),onClick:er,sx:{color:"#4CAF50",borderColor:"#4CAF50","&:hover":{borderColor:"#66BB6A",bgcolor:"rgba(76, 175, 80, 0.1)"}},children:"Test Run"}),(0,r.jsx)(d.Button,{variant:"contained",startIcon:(0,r.jsx)(c.A,{}),onClick:et,sx:{bgcolor:"#6366f1","&:hover":{bgcolor:"#5558e3"}},children:"Save Agent"}),(0,r.jsx)(d.Tooltip,{title:"Go to Chat",children:(0,r.jsx)(d.IconButton,{onClick:()=>e.push("/chat"),sx:{color:"#90CAF9"},children:(0,r.jsx)(u.A,{})})})]})]}),(0,r.jsxs)(d.Box,{sx:{display:"flex",flex:1,overflow:"hidden"},children:[(0,r.jsx)(f.A,{savedOwlAgents:q}),(0,r.jsxs)(d.Box,{ref:t,sx:{flex:1,position:"relative"},children:[(0,r.jsxs)(s.Gc,{nodes:b,edges:B,onNodesChange:S,onEdgesChange:T,onConnect:V,onInit:h,onDrop:W,onDragOver:X,onNodeClick:Y,onNodeDoubleClick:Q,nodeTypes:k,edgeTypes:w,fitView:!0,snapToGrid:!0,snapGrid:[15,15],defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"#6366f1",strokeWidth:2}},style:{background:"#0f0f1a"},children:[(0,r.jsx)(n.H,{}),(0,r.jsx)(l.o,{style:{backgroundColor:"#1e1e2f",border:"1px solid #2d2d44"},nodeColor:e=>{let t=(0,C.KF)(e.data?.type);return t?.color||"#607D8B"}}),(0,r.jsx)(i.V,{color:"#2d2d44",gap:20,size:1})]}),0===b.length&&(0,r.jsxs)(d.Box,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",pointerEvents:"none"},children:[(0,r.jsx)(d.Typography,{sx:{color:"#666",fontSize:"1.2rem",mb:1},children:"Drag nodes from the palette to get started"}),(0,r.jsx)(d.Typography,{sx:{color:"#444",fontSize:"0.9rem"},children:"Connect nodes to build your AI agent workflow"})]})]}),F&&O&&(0,r.jsx)(y.A,{nodeId:O.id,nodeData:O.data,onClose:ee,onSave:Z,savedOwlAgents:q},`config-${O.id}-${JSON.stringify(O.data.config||{})}`)]}),(0,r.jsx)(m.A,{open:R,onClose:()=>N(!1),onSave:ea}),(0,r.jsx)(v.A,{open:G,onClose:()=>H(!1),nodes:b,edges:B}),(0,r.jsx)(d.Snackbar,{open:$.open,autoHideDuration:4e3,onClose:eo,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(d.Alert,{onClose:eo,severity:$.severity,sx:{width:"100%"},children:$.message})})]})})}},97400:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\yrk20\\\\OwliaFabrica2\\\\app\\\\agent-builder\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\yrk20\\OwliaFabrica2\\app\\agent-builder\\page.tsx","default")}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[989,84,80,45,52,631],()=>a(84758));module.exports=r})();